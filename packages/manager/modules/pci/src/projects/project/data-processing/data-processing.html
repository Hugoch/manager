<div data-ui-view>
    <oui-page-header data-heading="{{ ::'data_processing_jobs' | translate }}">
        <oui-guide-menu data-text="{{:: 'pci_project_guides_header' | translate }}">
            <oui-guide-menu-item
                href="{{ $ctrl.guideUrl }}"
                data-external>
                <span data-translate="pci_project_guides_header_all_guides"></span>
            </oui-guide-menu-item>
        </oui-guide-menu>
    </oui-page-header>
    <div>
        <!-- cui messages -->
        <cui-message-container data-messages="$ctrl.messages"></cui-message-container>
        <oui-datagrid data-rows="$ctrl.jobs">
            <oui-column data-title="::'data_processing_job_name' | translate"
                        data-property="name"
                        data-sortable
                        data-type="string"
                        data-searchable
                        data-filterable>
                <oui-button
                    data-variant="link"
                    data-on-click="$ctrl.showJob($row.id)">
                    <span data-ng-bind="::$row.name"></span>
                </oui-button>
            </oui-column>
            <oui-column data-title="::'data_processing_region' | translate"
                        data-property="region"
                        data-type="string"
                        data-sortable
                        data-searchable
                        data-filterable>
                <span data-ng-bind="::$ctrl.cucRegionService.getTranslatedMicroRegion($row.region)"></span>
            </oui-column>
            <oui-column data-title="::'data_processing_job_type' | translate"
                        data-property="type"
                        data-sortable
                        data-searchable
                        data-filterable>
                <span data-ng-bind="::$row.type"></span>
            </oui-column>
            <oui-column data-title="::'data_processing_job_cores_ram' | translate"
                        data-property="vcores"
                        data-sortable>
                <span>{{ $row.vcores }}c/{{ $row.ram }}</span>
            </oui-column>
            <oui-column data-title="::'data_processing_job_creation_date' | translate"
                        data-property="creationDate"
                        data-sortable="desc">
                <span title="{{ ::$row.creationDate | momentFormat:'MMMM Do YYYY, h:mm:ss a'}}"
                      data-ng-bind="::$row.creationDate | momentRelative"></span>
            </oui-column>
            <oui-column data-title="::'data_processing_job_status' | translate"
                        data-property="status"
                        data-sortable>
                <dataprocessing-job-status data-status="$row.status"></dataprocessing-job-status>
            </oui-column>
            <oui-action-menu data-align="end" data-compact>
                <oui-action-menu-item
                    data-on-click="$ctrl.showJob($row.id)">
                    <span data-translate="data_processing_list_button_job_details"></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    data-href="{{ $ctrl.DATA_PROCESSING_UI_URL[$row.region]+'/'+$row.id }}"
                    data-ng-if="$ctrl.isJobRunning($row)"
                    data-external>
                    <span data-translate="data_processing_list_button_job_ui"></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    data-on-click="$ctrl.showJob($row.id)"
                    data-external>
                    <span data-translate="data_processing_list_button_job_monitoring"></span>
                </oui-action-menu-item>
                <oui-action-menu-item
                    class="joblist__action-button__danger"
                    data-ng-if="$ctrl.isJobRunning($row)"
                    data-on-click="$ctrl.terminateJob($row)">
                    <span data-translate="data_processing_list_button_job_terminate"></span>
                </oui-action-menu-item>
            </oui-action-menu>
            <extra-top>
                <div class="row">
                    <div class="col-auto mr-auto">
                        <oui-button data-on-click="$ctrl.submitJob()">
                            <span class="oui-icon oui-icon-add" aria-hidden="true"></span>
                            <span data-translate="data_processing_create_button_label"></span>
                        </oui-button>
                    </div>
                    <div class="col-auto">
                        <button type="button"
                                class="oui-button oui-button_secondary oui-button_icon-only oui-button_small-width"
                                aria-label="{{:: 'analytics_data_platform_list_table_refresh' | translate }}"
                                data-ng-click="$ctrl.refresh()">
                            <span class="fa fa-refresh" aria-hidden="true"></span>
                        </button>
                    </div>
                </div>
            </extra-top>
        </oui-datagrid>
    </div>
</div>
